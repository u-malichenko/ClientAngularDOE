<form [formGroup]="form" (ngSubmit)="submit()">
    <h1 *ngIf="event">Создание новой траты к событию   {{event.title}}</h1>

    <div
            class="form-control"
            [ngClass]="{invalid: form.get('buyer').touched && form.get('buyer').invalid}"
    >
        <label for="buyer">Плательщик:</label>
        <input id="buyer" type="text" formControlName="buyer">
        <div
                *ngIf="form.get('buyer').touched && form.get('buyer').invalid"
                class="validation"
        >
            <small *ngIf="form.get('buyer').errors.required">
                Введите плательщика, это поле не может быть пустым!
            </small>
        </div>
    </div>

    <div
            class="form-control"
            [ngClass]="{invalid: form.get('comment').touched && form.get('comment').invalid}"
    >
        <label for="comment">Коментарий:</label>
        <input id="comment" type="text" formControlName="comment">
        <div
                *ngIf="form.get('comment').touched && form.get('comment').invalid"
                class="validation"
        >
            <small *ngIf="form.get('comment').errors.required">
                Введите коментарий, это поле не может быть пустым так как это название. коментарий добавим после
                изменения бэка)!
            </small>
        </div>
    </div>

    <div
            class="form-control"
            [ngClass]="{invalid: form.get('expenseDate').touched && form.get('expenseDate').invalid}"
    >
        <label for="expenseDate">Дата: </label>
        <input id="expenseDate" type="datetime-local" formControlName="expenseDate">
        <div
                *ngIf="form.get('expenseDate').touched && form.get('expenseDate').invalid"
                class="validation"
        >
            <small *ngIf="form.get('expenseDate').errors.required">
                Введите дату и время. Дата траты, не может быть пустой!
            </small>
        </div>
    </div>


    <div
            class="form-control"
            [ngClass]="{invalid: form.get('totalExpenseSum').touched && form.get('totalExpenseSum').invalid}"
    >
        <label for="totalExpenseSum">Сумма: </label>
        <input id="totalExpenseSum" type="text" formControlName="totalExpenseSum">
        <div
                *ngIf="form.get('totalExpenseSum').touched && form.get('totalExpenseSum').invalid"
                class="validation"
        >
            <small *ngIf="form.get('totalExpenseSum').errors.required">
                Введите сумму траты, она не может быть пустой!
            </small>
            <small *ngIf="form.get('totalExpenseSum').errors.pattern">
                НЕ верное число! pattern(/^[.\d]+$/)
            </small>
        </div>
    </div>

    <div
            style="margin-top: 1rem"
            style="margin-bottom: 1rem"
            class="form-control"
            id="direct">
        <label class="form-control" for="direct">Добавить direct пользователя: </label>
        <div
                class="form-control"
                style="width: 500px"
                [ngClass]="{invalid: form.get('newDirectUser').touched && form.get('newDirectUser').invalid}"
        >
            <input id="newDirectUser" type="text" placeholder="Имя DirectUser " formControlName="newDirectUser">
            <div
                    *ngIf="form.get('newDirectUser').touched && form.get('newDirectUser').invalid"
                    class="validation"
            >
                <small *ngIf="form.get('newDirectUser').errors.required">
                    Имя должника, не может быть пустым!
                </small>
            </div>
        </div>

        <div
                class="form-control"
                style="width: 500px"
                [ngClass]="{invalid: form.get('newDirectSum').touched && form.get('newDirectSum').invalid}"
        >
            <input id="newDirectSum" type="text" placeholder="Сумма" formControlName="newDirectSum">
            <div
                    *ngIf="form.get('newDirectSum').touched && form.get('newDirectSum').invalid"
                    class="validation"
            >
                <small *ngIf="form.get('newDirectSum').errors.required">
                    Введите сумму долга, она не может быть пустой!
                </small>
                <small *ngIf="form.get('newDirectSum').errors.pattern">
                    НЕ верное число! pattern(/^[.\d]+$/)
                </small>
            </div>
        </div>

        <a
                *ngIf="!form.get('newDirectSum').invalid && !form.get('newDirectUser').invalid "
                (click)="addDirectUser(form.get('newDirectUser').value, form.get('newDirectSum').value)"
                class="text-danger"
        >Добавить участника Direct</a>
        <div>
            <label>Список Direct участников:</label>
            <table>
                <thead>
                <tr>
                    <th>#</th>
                    <th>Ник</th>
                    <th>Сумма</th>
                    <th>Действия</th>
                </tr>
                </thead>
                <tbody>
                <tr
                        *ngFor="let directPayer of directPayerMap; let idx = index">
                    <td>{{ idx + 1 }}</td>
                    <td>{{ directPayer.userName }}</td>
                    <td>{{ directPayer.sum | localizedCurrency: 'RUB': 'symbol-narrow'}}</td>
                    <td>
                        <a (click)="removeDirectUser(directPayer)">Удалить</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div
            style="margin-top: 1rem"
            style="margin-bottom: 1rem"
            class="form-control"
            id="partitial">
        <label
                class="form-control"
                for="partitial"
        >Добавить Partitial пользователя: </label>
        <div
                class="form-control"
                style="width: 500px"
                [ngClass]="{invalid: form.get('newPartitialUser').touched && form.get('newPartitialUser').invalid}"
        >
            <input id="newPartitialUser" type="text" placeholder="Имя PartitialUser "
                   formControlName="newPartitialUser">
            <div
                    *ngIf="form.get('newPartitialUser').touched && form.get('newPartitialUser').invalid"
                    class="validation"
            >
                <small *ngIf="form.get('newPartitialUser').errors.required">
                    Имя должника, не может быть пустым!
                </small>
            </div>
        </div>

        <div
                class="form-control"
                style="width: 500px"
                [ngClass]="{invalid: form.get('newPartitialPart').touched && form.get('newPartitialPart').invalid}"
        >
            <input id="newPartitialPart" type="text" placeholder="Коэфициент" formControlName="newPartitialPart">
            <div
                    *ngIf="form.get('newPartitialPart').touched && form.get('newPartitialPart').invalid"
                    class="validation"
            >
                <small *ngIf="form.get('newPartitialPart').errors.required">
                    Введите сумму долга, она не может быть пустой!
                </small>
                <small *ngIf="form.get('newPartitialPart').errors.pattern">
                    НЕ верное число! pattern(/^[.\d]+$/)
                </small>
            </div>
        </div>

        <a
                *ngIf="!form.get('newPartitialPart').invalid && !form.get('newPartitialPart').invalid "
                (click)="addPartitialUser(form.get('newPartitialPart').value, form.get('newPartitialPart').value)"
                class="text-danger"
        >Добавить участника Partitial</a>
        <div>
            <label>Список Partitial участников:</label>
            <table>
                <thead>
                <tr>
                    <th>#</th>
                    <th>Ник</th>
                    <th>Коэфициент</th>
                    <th>Действия</th>
                </tr>
                </thead>
                <tbody>
                <tr
                        *ngFor="let partitialPayer of partitialPayerMap; let idx = index">
                    <td>{{ idx + 1 }}</td>
                    <td>{{ partitialPayer.userName }}</td>
                    <td>{{ partitialPayer.cof}}</td>
                    <td>
                        <a (click)="removePartitialUser(partitialPayer)">Удалить</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

    </div>

    <button
            type="submit"
            class="btn btn-block btn-primary"
            style="margin-top: 1rem"
            style="margin-bottom: 1rem"
            [disabled]="form.get('buyer').invalid
            || form.get('comment').invalid
            || form.get('expenseDate').invalid
            || form.get('totalExpenseSum').invalid"
    >Создать
    </button>
</form>
